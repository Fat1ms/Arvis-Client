# TTS Engine Selector - –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –í—ã–±–æ—Ä TTS –¥–≤–∏–∂–∫–∞ (Silero vs Bark)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω UI —Å–µ–ª–µ–∫—Ç–æ—Ä –≤ Settings ‚Üí TTS/STT
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –≤ –∫–æ–Ω—Ñ–∏–≥ (`tts.default_engine`)
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É Silero –∏ Bark

### 2. –¢–µ–≥–∏ –≥–æ–ª–æ—Å–æ–≤ –ø–æ —Ç–∏–ø–∞–º
- ‚úÖ –ì–æ–ª–æ—Å–∞ –ø–æ–º–µ—á–µ–Ω—ã —Ç–µ–≥–∞–º–∏ `[Silero]` –∏ `[Bark]` –≤ UI
- ‚úÖ –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –¥–≤–∏–∂–∫–∞ —Å–ø–∏—Å–æ–∫ –≥–æ–ª–æ—Å–æ–≤ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ Per-engine voice persistence:
  - Silero –≥–æ–ª–æ—Å–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `tts.voice`
  - Bark –≥–æ–ª–æ—Å–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `tts.bark.voice`

### 3. –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–µ –≥–æ–ª–æ—Å–∞ Bark
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä—É—Å—Å–∫–∏–µ/—É–∫—Ä–∞–∏–Ω—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞:
  - `v2/multilingual_00`
  - `v2/multilingual_01`
  - –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Bark –¥–ª—è RU/UK —Ç–µ–∫—Å—Ç–æ–≤

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ PyQt6
- ‚úÖ –ó–∞–º–µ–Ω–∞ `Qt.MatchStartsWith` –Ω–∞ —Ä—É—á–Ω—É—é –ª–æ–≥–∏–∫—É —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- ‚úÖ –ó–∞–º–µ–Ω–∞ `Qt.LeftButton` –Ω–∞ `Qt.MouseButton.LeftButton`
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏ enum –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç PyQt6

### 5. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ `omegaconf` –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π Python (–¥–ª—è subprocess TTS worker)
- ‚úÖ –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å Silero —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç venv Python
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `config.save_config()` –≤ `apply_settings()` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ –¥–∏—Å–∫
- ‚úÖ Config –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ

## üìã –§–∞–π–ª—ã –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã

### Core TTS:
- `modules/tts_factory.py` ‚Äî factory –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–≤–∏–∂–∫–æ–≤
- `modules/tts_base.py` ‚Äî –±–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã set_mode/set_enabled)
- `modules/silero_tts_engine.py` ‚Äî Silero —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (venv detection, subprocess fixes)
- `modules/bark_tts_engine.py` ‚Äî Bark —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (multilingual voices)
- `modules/tts_worker_subprocess.py` ‚Äî subprocess worker

### UI:
- `src/gui/settings_dialog.py` ‚Äî Settings UI —Å engine selector –∏ voice tags
- `src/gui/main_window.py` ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã PyQt6 enum –æ—à–∏–±–∫–∏

### Config:
- `config/config.py` ‚Äî Config abstraction layer
- `config/config.json` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–µ settings

### –£—Ç–∏–ª–∏—Ç—ã:
- `test_tts_simple.py` ‚Äî —Ç–µ—Å—Ç-–Ω–∞–±–æ—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ TTS
- `test_tts_subprocess.py` ‚Äî —Ç–µ—Å—Ç subprocess —Å omegaconf
- `launch.py` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è venv (–æ–ø—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –¢—Ä–µ–±—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã:
```bash
pip install omegaconf    # –¥–ª—è Silero TTS worker
pip install bark-ml      # –¥–ª—è Bark TTS
pip install torch torchaudio  # –º–æ–¥–µ–ª–∏
pip install PyQt6        # GUI
```

### –°—Ç–∞—Ç—É—Å –≤ –≤–∞—à–µ–π —Å—Ä–µ–¥–µ:
- ‚úÖ `omegaconf==2.3.0` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π Python –∏ venv
- ‚úÖ `bark` –º–æ–¥—É–ª—å ‚Äî –¥–æ—Å—Ç—É–ø–µ–Ω (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –∏–º–ø–æ—Ä—Ç–æ–º –≤ —Ç–µ—Å—Ç–∞—Ö)
- ‚úÖ `PyQt6` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)
- ‚ö†Ô∏è `torch/torchaudio` ‚Äî –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Silero

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
cd Arvis-Client
python main.py
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Python –µ—Å–ª–∏ all –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –° —è–≤–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π venv (–µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã)
```bash
cd Arvis-Client
.\venv\Scripts\activate
python main.py
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
```bash
python test_tts_simple.py
```
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: `Total: 3/3 tests passed`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ subprocess:
```bash
python test_tts_subprocess.py
```

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   python main.py
   ```

2. **–û—Ç–∫—Ä—ã—Ç—å Settings (Ctrl+,)**

3. **–í—ã–±—Ä–∞—Ç—å TTS –¥–≤–∏–∂–æ–∫:**
   - Settings ‚Üí TTS/STT ‚Üí TTS Engine Selector
   - –í—ã–±—Ä–∞—Ç—å `Bark` –∏–ª–∏ `Silero`

4. **–í—ã–±—Ä–∞—Ç—å –≥–æ–ª–æ—Å:**
   - –°–ø–∏—Å–æ–∫ –≥–æ–ª–æ—Å–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞
   - –î–ª—è Bark –¥–æ—Å—Ç—É–ø–Ω—ã –º–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–µ –≥–æ–ª–æ—Å–∞ (RU/UK)

5. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å (Save button):**
   - –í—ã–±–æ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ `config/config.json`

6. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**
   - –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º/–∞–Ω–≥–ª–∏–π—Å–∫–æ–º
   - –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É Speak/Play
   - –ü—Ä–æ–∏–∑–æ–π–¥—ë—Ç —Å–∏–Ω—Ç–µ–∑ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –¥–≤–∏–∂–∫–æ–º –∏ –≥–æ–ª–æ—Å–æ–º

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### config/config.json –∫–ª—é—á–∏:
```json
{
  "tts": {
    "default_engine": "bark",     // –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ (silero|bark)
    "voice": "aidar",              // –≥–æ–ª–æ—Å Silero
    "bark": {
      "voice": "v2/multilingual_00" // –≥–æ–ª–æ—Å Bark
    }
  }
}
```

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: "No module named 'omegaconf'"
**–†–µ—à–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å omegaconf
```bash
pip install omegaconf
.\venv\Scripts\pip install omegaconf
```

### –ü—Ä–æ–±–ª–µ–º–∞: "AttributeError: 'Qt' has no attribute 'LeftButton'"
**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ `Qt.MouseButton.LeftButton` ‚úÖ (FIXED)

### –ü—Ä–æ–±–ª–µ–º–∞: –°–∏–Ω—Ç–µ–∑ —Å Bark –º–µ–¥–ª–µ–Ω–Ω—ã–π –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ ‚Äî Bark –∑–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ (~500MB). –î–∞–ª—å—à–µ –±—É–¥–µ—Ç –±—ã—Å—Ç—Ä–µ–µ.

### –ü—Ä–æ–±–ª–µ–º–∞: Subprocess –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Python
**–†–µ—à–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç venv Python (`./venv/Scripts/python.exe`) ‚úÖ

## ‚ú® –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- ‚úÖ –ö–æ–Ω—Ñ–∏–≥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- ‚úÖ –í—Å–µ TTS –º–æ–¥—É–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ PyQt6 enum –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ omegaconf –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ subprocess
- ‚úÖ bark –º–æ–¥—É–ª—å –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ Test suite: 3/3 passed

## üìû –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø–µ—Ä–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É –º–æ–¥–µ–ª–∏ Silero** (~5-10 –º–∏–Ω—É—Ç)
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏–Ω—Ç–µ–∑ —Å –æ–±–æ–∏–º–∏ –¥–≤–∏–∂–∫–∞–º–∏:**
   - –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç
   - –ù–∞–∂–∞—Ç—å Play/Speak
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∑–≤—É–∫ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** –ø—Ä–∏ —Å–∏–Ω—Ç–µ–∑–µ:
   ```bash
   tail -f logs/arvis_*.log
   ```
   –ò—â–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:
   - "Using venv Python:" ‚Äî –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—É—Ç—å –∫ venv
   - "Starting subprocess TTS:" ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–æ–ª–æ—Å–µ –∏ —Ç–µ–∫—Å—Ç–µ
   - "TTS synthesis completed" ‚Äî —É—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ

## üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `docs/BARK_TTS_SETUP.md` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ Bark
- `docs/CLIENT_API_DOCS_INDEX.md` ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞
- `README.md` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

---

**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é ‚úÖ
**–î–∞—Ç–∞:** 24 –æ–∫—Ç—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 1.0 Multi-Engine TTS
